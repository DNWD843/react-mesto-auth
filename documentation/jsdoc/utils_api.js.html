<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/api.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/api.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @description  Класс Api &lt;br>
 * Отвечает за отправку запросов на сервер и проверку полученных ответов
 * @param {Object} Object - принимает в конструктор объект { URLs, headers, token }
 * @param {Object} Object.URLs  - объект, содержащий адреса для отправки запросов
 * @param {String} Object.URLs.baseURL - базовый URL сервера
 * @param {String} Object.URLs.cardsURL - URL для получения/добавления карточек
 * @param {String} Object.URLs.userURL - URLдля получения/добавления данных пользователя
 * @param {String} Object.URLs.likesURL - URL для получения/добавления информации о "лайках"
 * @param {String} Object.URLs.avatarURL - URL для получения/добавления ссылки на аватар
 * @param {Object} Object.headers - объект, содержащий заголовки запросов
 * @param {String} Object.headers.authorization - код авторизации (токен)
 * @param {String} Object.token  - токен для доступа на сервер
 * @since v.1.0.0
 * @example
 * const api = new Api({
 * URLs: {
 *   baseURL: 'https://mesto...',
 *   cardsURL: 'https://mesto.../cards/',
 *   userURL: 'https://mesto.../users/me',
 *   likesURL: 'https://mesto.../cards/likes/',
 *   avatarURL: 'https://mesto.../users/me/avatar'
 * },
 * headers: {
 *   "authorization": '&lt;Ваш код авторизации>'
 * },
 * token: '&lt;Ваш токен>'
 * });
 */
class Api {
  constructor({ URLs, headers, token }) {
    this._baseURL = URLs.baseURL;
    this._cardsURL = URLs.cardsURL;
    this._userURL = URLs.userURL;
    this._likesURL = URLs.likesURL;
    this._avatarURL = URLs.avatarURL;
    this._headers = headers;
    this._token = token;
  }

  /**
   * @description  Публичный метод&lt;br>
   * Загружает с сервера данные пользователя
   * @public
   * @returns {Promise} - возвращает промис с данными пользователя
   * @since v.1.0.0
   */
  loadUserData() {
    return fetch(this._userURL, {
      headers: {
        authorization: this._token,
      },
    }).then((res) => {
      if (res.ok) {
        return res.json();
      }
      return Promise.reject(`Ошибка: ${res.status}`);
    });
  }

  /**
   * @description  Публичный метод&lt;br>
   * Загружает элементы с сервера
   * @public
   * @returns {Promise} - возвращает промис с данными элементов, сохраненных на сервере
   * @since v.1.0.0
   */
  loadCards() {
    return fetch(this._cardsURL, {
      headers: {
        authorization: this._token,
      },
    }).then((res) => {
      if (res.ok) {
        return res.json();
      }
      return Promise.reject(`Ошибка: ${res.status}`);
    });
  }

  /**
   * @description Публичный метод&lt;br>
   * Сохраняет на сервер элемент, добавленный через Форму добавления нового элемента&lt;br>
   * Принимает аргументом объект item
   * @public
   * @param {Object} item  - объект с параметрами элемента
   * @param {String} item.name - название элемента из инпута Формы добавления нового элемента
   * @param {String} item.link - ссылка на изображение элемента из инпута Формы добавления нового элемента
   * @returns {Promise} - возвращает промис, содержащий данные нового элемента, полученные от сервера
   * @since v.1.0.0
   * @example
   * api.addNewCard({name: &lt;название элемента>, link: &lt;ссылка на изображение элемента>})
   */
  addNewCard(item) {
    return fetch(this._cardsURL, {
      method: "POST",
      headers: {
        authorization: this._token,
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        name: item.name,
        link: item.link,
      }),
    }).then((res) => {
      if (res.ok) {
        return res.json();
      }
      return Promise.reject(`Ошибка: ${res.status}`);
    });
  }

  /**
   * @description Публичный метод&lt;br>
   * Удаляет элемент с сервера&lt;br>
   * Принимает аргументом id удаляемого элемента
   * @public
   * @param {String} cardId  - id удаляемого элемента
   * @returns {Promise} - возвращает промис с сообщением об успешном удалении элемента
   * @since v.1.0.0
   */
  deleteCard(cardId) {
    return fetch(`${this._cardsURL}${cardId}`, {
      method: "DELETE",
      headers: {
        authorization: this._token,
      },
    }).then((res) => {
      if (res.ok) {
        return res.json();
      }
      return Promise.reject(`Ошибка: ${res.status}`);
    });
  }

  /**
   * @description Публичный метод&lt;br>
   * Редактирует данные в профиле пользователя на сервере&lt;br>
   * Принимает арументом объект с новыми данными пользователя, веденными через Форму редактирования профиля
   * @public
   * @param {Object} Object  - { name, about } - объект с новыми данными пользователя
   * @param {String} Object.name - новое имя пользователя, введенное в Форму редактирования профиля
   * @param {String} Object.about - новое описание пользователя, введенное в Форму редактирования профиля
   * @returns {Promise} - возвращает промис, содержащий новые данные пользователя, сохраненные на сервере
   * @since v.1.0.0
   * @example
   * api.editProfile({
   *   name: &lt;новое имя пользователя, введенное в инпут Формы редактирования профиля>,
   *   job: &lt;новое описание пользователя, введенное в инпут Формы редактирования профиля >
   * });
   */
  editProfile({ name, about }) {
    return fetch(`${this._userURL}`, {
      method: "PATCH",
      headers: {
        authorization: this._token,
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        name,
        about,
      }),
    }).then((res) => {
      if (res.ok) {
        return res.json();
      }
      return Promise.reject(`Ошибка: ${res.status}`);
    });
  }

  /**
   * @description Публичный метод&lt;br>
   * Изменяет статус кнопки "лайк" у карточки&lt;br>
   * Принимает аргументом id карточки, у которой произошло нажатие "лайка" и новое состояние "лайка"
   * @public
   * @param {String} id - id элемента, на котором произошло нажатие "лайка"
   * @param {Boolean} likeStatus - новое состояние "лайка": если true - "лайк" поставлен, если false - "лайк" снят
   * @returns {Promise} - возвращает промис, содержащий новые данные пользователя, сохраненные на сервере
   * @public
   * @since v2.0.2
   */
  changeLikeCardStatus(id, likeStatus) {
    return fetch(`${this._likesURL}${id}`, {
      method: `${likeStatus ? "PUT" : "DELETE"}`,
      headers: {
        authorization: this._token,
      },
    }).then((res) => {
      if (res.ok) {
        return res.json();
      }
      return Promise.reject(`Ошибка: ${res.status}`);
    });
  }

  /**
   * @description Публичный метод&lt;br>
   * Сохраняет на сервер новую ссылку на аватар пользователя&lt;br>
   * Принимает аргументом ссылку на новый аватар пользователя, полученную из Формы редактирования аватара
   * @public
   * @param {String} avatar - новая ссылка на аватар пользователя, полученная из Формы редактирования аватара
   * @returns {Promise} - возвращает промис, содержащий новые данные пользователя, сохраненные на сервере
   * @since v.1.0.0
   */
  editAvatar(avatar) {
    return fetch(`${this._avatarURL}`, {
      method: "PATCH",
      headers: {
        authorization: this._token,
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        avatar: avatar,
      }),
    }).then((res) => {
      if (res.ok) {
        return res.json();
      }
      return Promise.reject(`Ошибка: ${res.status}`);
    });
  }
}

/**
 * @constant api
 * @description Экземпляр класса Api&lt;br>
 * Экспортируется в компонент App
 * @memberof Api
 * @instance
 * @since v.2.0.0
 */
const api = new Api({
  URLs: {
    baseURL: "https://mesto.nomoreparties.co/v1/cohort-14/",
    cardsURL: "https://mesto.nomoreparties.co/v1/cohort-14/cards/",
    userURL: "https://mesto.nomoreparties.co/v1/cohort-14/users/me/",
    likesURL: "https://mesto.nomoreparties.co/v1/cohort-14/cards/likes/",
    avatarURL: "https://mesto.nomoreparties.co/v1/cohort-14/users/me/avatar/",
  },
  headers: {
    authorization: "85abb6e6-ccb0-45c7-b6e8-4ffe1f5da546",
  },
  token: "85abb6e6-ccb0-45c7-b6e8-4ffe1f5da546",
});

export default api;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AddPlacePopup.html">AddPlacePopup</a></li><li><a href="module-auth.html">auth</a></li><li><a href="module-Card.html">Card</a></li><li><a href="module-DeleteConfirmPopup.html">DeleteConfirmPopup</a></li><li><a href="module-EditAvatarPopup.html">EditAvatarPopup</a></li><li><a href="module-EditProfilePopup.html">EditProfilePopup</a></li><li><a href="module-Footer.html">Footer</a></li><li><a href="module-Header.html">Header</a></li><li><a href="module-ImagePopup.html">ImagePopup</a></li><li><a href="module-index.html">index</a></li><li><a href="module-InfoToolTip.html">InfoToolTip</a></li><li><a href="module-Login.html">Login</a></li><li><a href="module-Main.html">Main</a></li><li><a href="module-NavBar.html">NavBar</a></li><li><a href="module-PopupWithForm.html">PopupWithForm</a></li><li><a href="module-Register.html">Register</a></li><li><a href="module-StartPageWithForm.html">StartPageWithForm</a></li><li><a href="module-token.html">token</a></li><li><a href="module-useFormWithValidation.html">useFormWithValidation</a></li></ul><h3>Classes</h3><ul><li><a href="Api.html">Api</a></li><li><a href="App.html">App</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Nov 15 2020 05:48:41 GMT+0300 (Москва, стандартное время)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
