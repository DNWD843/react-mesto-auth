<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/FormValidator/FormValidator.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/FormValidator/FormValidator.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @description Класс FormValidator&lt;br>
 * Определяет логику валидации форм в модальных окнах приложения&lt;br>
 * Для каждой формы создается свой экземпляр класса FormValidator&lt;br>
 * Класс имеет один публичный метод, запускающий валидацию - enableValidation()&lt;br>
 * Класс принимает в конструктор объект настроек config и DOM-ноду формы, для которой необходимо запустить валидацию&lt;br>
 * &lt;b>ПРИМЕЧАНИЕ:&lt;/b>&lt;br>
 * Для корректной работы валидации при добавлении новых форм, необходимо придерживаться описанного ниже порядка
 * присваивания значений атрибутов name и id в формах и открывающих их кнопках.&lt;br>
 * Поиск кнопки, открывающей форму, производится по ее id.&lt;br>
 * id кнопки состоит из id формы, которую он открывает, и слова button, добавленного через дефис.&lt;br>
 * id формы, в свою очередь, имеет значение равное значению атрибута name этой же формы.&lt;br>
 * Пример:&lt;br>
 * Форма в модальном окне:
 * form  name="add-photo-form" id="add-photo-form"&lt;br>
 * Кнопка, открывающая форму:
 * button  name="add-photo-form-button" id="add-photo-form-button"&lt;br>
 * @param {Object} config - объект настроек валидации, содержит селекторы элементов и классы, необходимые для валидации
 * @param {String} config.inputSelector - селектор инпута формы, общий для всех инпутов
 * @param {String} config.submitButtonSelector - селектор кнопки отправки формы (submit)
 * @param {String} config.inactiveButtonClass - css класс, устанавливающй неактивное состояние кнопки submit
 * @param {String} config.inputErrorClass - css класс, устанавливающй невалидное состояние инпута
 * @param {String} config.errorClass - css класс, устанавливающй активное состояние элемента, содержащего текст ошибки
 * @param {HTMLFormElement} formNode - DOM-нода формы, для которой необходимо запустить валидацию
 * @since v.1.0.0
 */
class FormValidator {
  constructor(config, formNode) {
    this._inputSelector = config.inputSelector;
    this._submitButtonSelector = config.submitButtonSelector;
    this._inactiveButtonClass = config.inactiveButtonClass;
    this._inputErrorClass = config.inputErrorClass;
    this._errorClass = config.errorClass;
    this._formElement = formNode;
  }

  /**
   * @description Приватный метод&lt;br>
   * Метод вывода сообщения об ошибке
   * @private
   * @param {HTMLElement} inputElement - инпут формы (один из нескольких или единственный)
   * @param {String} errorMesage - сообщение об ошибке
   */
  _showInputError(inputElement, errorMesage) {
    const errorElement = this._formElement.querySelector(`#${inputElement.id}-error`);
    inputElement.classList.add(this._inputErrorClass);
    errorElement.textContent = errorMesage;
    errorElement.classList.add(this._errorClass);
  }

  /**
   * @description Приватный метод&lt;br>
   * Метод скрытия сообщения об ошибке
   * @private
   * @param {HTMLElement} inputElement - инпут формы (один из нескольких или единственный)
   */
  _hideInputError(inputElement) {
    const errorElement = this._formElement.querySelector(`#${inputElement.id}-error`);
    inputElement.classList.remove(this._inputErrorClass);
    errorElement.classList.remove(this._errorClass);
    errorElement.textContent = '';
  }

  /**
   * @description Приватный метод&lt;br>
   * Метод проверки валидности инпутов в форме&lt;br>
   * Метод как бы отвечает на вопрос: этот инпут валиден?&lt;br>
   * &amp;nbsp Если да, то для этого инпута вызывается приватный метод скрытия ошибок _hideInputError&lt;br>
   * &amp;nbsp Если нет, то для этого инпута вызывается приватный метод отображения ошибок _showInputError&lt;br>
   * @private 
   * @param {HTMLElement} inputElement - инпут формы (один из нескольких или единственный)
   */
  _isInputValid(inputElement) {
    if (!inputElement.validity.valid) {
      this._showInputError(inputElement, inputElement.validationMessage);
    } else {
      this._hideInputError(inputElement);
    }
  }

  /**
   * @description Приватный метод&lt;br>
   * Метод проверки наличия невалидных инпутов в форме&lt;br>
   * Метод перебирает все инпуты формы и проверяет каждый на валидность&lt;br>
   * Метод как бы отвечает на вопрос: в этой форме есть хотя бы один невалидный инпут?&lt;br>
   * Возвращает true, если в форме есть хотя бы один невалидный инпут&lt;br>
   * Возвращает false, если в форме нет ни одного невалидного инпута
   * @param {Array} inputList - массив, список инпутов формы
   * @private 
   */
  _hasInvalidInput(inputList) {
    return inputList.some((inputElement) => {
      /**
       * Валидность инпута определяется по состоянию свойства validity объекта ValidityState
       * @ignore
       */
      return !inputElement.validity.valid;
    });
  }

  /**
   * @description Приватный метод&lt;br>
   * Изменяет состояние кнопки отправки формы (submit) в зависимости от валидности или невалидности инпутов формы&lt;br>
   * Если форма содержит хотя бы один невалидный инпут, кнопка submit становится неактивной
   * @private
   * @param {Array} inputList - массив инпутов формы
   * @param {HTMLElement} buttonElement - DOM-элемент кнопки отправки формы (submit) 
   */
  _toggleButtonState(inputList, buttonElement) {
    if (this._hasInvalidInput(inputList)) {
      buttonElement.classList.add(this._inactiveButtonClass);
      buttonElement.setAttribute('disabled', true);
    } else {
      buttonElement.classList.remove(this._inactiveButtonClass);
      buttonElement.removeAttribute('disabled');
    }
  }

  /**
   * @description Приватный метод&lt;br>
   * Метод сброса валидации&lt;br>
   * Если пользователь заполнял форму, но передумал отправлять данные и закрыл ее, то, несмотря на очистку инпутов при открытии форм,&lt;br>
   * в форме остаются ошибки и стили невалидных инпутов.&lt;br>
   * Метод _resetValidation очищает форму от ошибок и невалидных стилей, оставшихся после предыдущего сеанса работы пользователя с формой
   * @private
   * @param {Array} inputList - массив инпутов формы
   * @param {HTMLElement} buttonElement - DOM-элемент кнопки отправки формы (submit)
   */
  _resetValidation(inputList, buttonElement) {
    inputList.forEach((input) => {
      this._hideInputError(input);
    });
    this._toggleButtonState(inputList, buttonElement);
  }

  /**
   * @description Приватный метод&lt;br>
   * Метод установки слушателей на элементы формы
   * @private
   */
  _setEventListeners() {
    const inputList = Array.from(this._formElement.querySelectorAll(this._inputSelector));
    const buttonElement = this._formElement.querySelector(this._submitButtonSelector);
    const openFormButton = document.querySelector(`#${this._formElement.id}-button`);
    
    this._toggleButtonState(inputList, buttonElement);
    inputList.forEach((inputElement) => {
      inputElement.addEventListener('input', () => {
        this._isInputValid(inputElement);
        this._toggleButtonState(inputList, buttonElement);
      });
    });
    openFormButton.addEventListener('click', () => {
      this._resetValidation(inputList, buttonElement);
    });
  }

  /**
   * @description Публичный метод&lt;br>
   * Включает валидацию формы&lt;br>
   * Включение валидации производится один раз.&lt;br>
   * Далее валидация осуществляется постоянно при взаимодействии пользователя с формой
   * @public
   * @since v.2.0.1
   */
  enableValidation() {
    this._formElement.addEventListener('submit', (evt) => {
      evt.preventDefault();
    });
    this._setEventListeners();
  }
}

export default FormValidator;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AddPlacePopup.html">AddPlacePopup</a></li><li><a href="module-Card.html">Card</a></li><li><a href="module-DeleteConfirmPopup.html">DeleteConfirmPopup</a></li><li><a href="module-EditAvatarPopup.html">EditAvatarPopup</a></li><li><a href="module-EditProfilePopup.html">EditProfilePopup</a></li><li><a href="module-Footer.html">Footer</a></li><li><a href="module-Header.html">Header</a></li><li><a href="module-ImagePopup.html">ImagePopup</a></li><li><a href="module-index.html">index</a></li><li><a href="module-Main.html">Main</a></li><li><a href="module-PopupWithForm.html">PopupWithForm</a></li></ul><h3>Namespaces</h3><ul><li><a href="constants.html">constants</a></li></ul><h3>Classes</h3><ul><li><a href="Api.html">Api</a></li><li><a href="App.html">App</a></li><li><a href="FormValidator.html">FormValidator</a></li></ul><h3>Global</h3><ul><li><a href="global.html#CurrentUserContext">CurrentUserContext</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Sun Sep 27 2020 21:24:56 GMT+0300 (GMT+03:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
